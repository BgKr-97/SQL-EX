## –ó–∞–¥–∞–Ω–∏–µ 6

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, –≤—ã–ø—É—Å–∫–∞—é—â–µ–≥–æ –ü–ö-–±–ª–æ–∫–Ω–æ—Ç—ã c –æ–±—ä—ë–º–æ–º –∂–µ—Å—Ç–∫–æ–≥–æ –¥–∏—Å–∫–∞ –Ω–µ –º–µ–Ω–µ–µ 10 –ì–±–∞–π—Ç, –Ω–∞–π—Ç–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ç–∞–∫–∏—Ö –ü–ö-–±–ª–æ–∫–Ω–æ—Ç–æ–≤. 

**–í—ã–≤–µ—Å—Ç–∏: –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å, —Å–∫–æ—Ä–æ—Å—Ç—å**.

```sql
SELECT DISTINCT p.maker,
                l.speed
FROM product AS p
JOIN laptop AS l
     ON p.model = l.model AND l.type = 'Laptop'
WHERE l.hd >= 10
```

## –ó–∞–¥–∞–Ω–∏–µ 7

–ù–∞–π–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –º–æ–¥–µ–ª–µ–π –∏ —Ü–µ–Ω—ã –≤—Å–µ—Ö –∏–º–µ—é—â–∏—Ö—Å—è –≤ –ø—Ä–æ–¥–∞–∂–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–ª—é–±–æ–≥–æ —Ç–∏–ø–∞) –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è B (–ª–∞—Ç–∏–Ω—Å–∫–∞—è –±—É–∫–≤–∞). 

```sql
SELECT DISTINCT P.MODEL,
                COALESCE(PC.PRICE, L.PRICE, PR.PRICE)
FROM PRODUCT AS P
LEFT JOIN PC
     ON PC.MODEL = P.MODEL
LEFT JOIN LAPTOP AS L
     ON L.MODEL = P.MODEL
LEFT JOIN PRINTER AS PR
     ON PR.MODEL = P.MODEL
WHERE P.MAKER = 'B' AND COALESCE(PC.MODEL, L.MODEL, PR.MODEL) IS NOT NULL
```

## –ó–∞–¥–∞–Ω–∏–µ 8

–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, –≤—ã–ø—É—Å–∫–∞—é—â–µ–≥–æ –ü–ö, –Ω–æ –Ω–µ –ü–ö-–±–ª–æ–∫–Ω–æ—Ç—ã.

```sql
SELECT DISTINCT maker
FROM product
WHERE TYPE = 'PC' AND maker NOT IN
      (SELECT DISTINCT maker
       FROM product
       WHERE TYPE = 'Laptop')
```

## –ó–∞–¥–∞–Ω–∏–µ 15

–ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã –∂–µ—Å—Ç–∫–∏—Ö –¥–∏—Å–∫–æ–≤, —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —É –¥–≤—É—Ö –∏ –±–æ–ª–µ–µ PC. 

**–í—ã–≤–µ—Å—Ç–∏: HD**

```sql
SELECT hd
FROM pc
GROUP BY hd
HAVING count(*) >= 2
```

## –ó–∞–¥–∞–Ω–∏–µ 16

–ù–∞–π–¥–∏—Ç–µ –ø–∞—Ä—ã –º–æ–¥–µ–ª–µ–π PC, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ RAM. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∫–∞–∂–¥–∞—è –ø–∞—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, —Ç.–µ. (i,j), –Ω–æ –Ω–µ (j,i), 
–ü–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞: –º–æ–¥–µ–ª—å —Å –±–æ–ª—å—à–∏–º –Ω–æ–º–µ—Ä–æ–º, –º–æ–¥–µ–ª—å —Å –º–µ–Ω—å—à–∏–º –Ω–æ–º–µ—Ä–æ–º, —Å–∫–æ—Ä–æ—Å—Ç—å –∏ RAM.

```sql
SELECT DISTINCT t2.model,
                t1.model,
                t1.speed,
                t1.ram
FROM pc AS t1
JOIN pc AS t2
     ON t1.speed = t2.speed AND t1.ram = t2.ram
WHERE t2.model > t1.model
```

## –ó–∞–¥–∞–Ω–∏–µ 17

–ù–∞–π–¥–∏—Ç–µ –º–æ–¥–µ–ª–∏ –ü–ö-–±–ª–æ–∫–Ω–æ—Ç–æ–≤, —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –º–µ–Ω—å—à–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –ü–ö.

**–í—ã–≤–µ—Å—Ç–∏: type, model, speed**

```sql
SELECT DISTINCT 'Laptop',
                model,
                speed
FROM Laptop
WHERE speed < all(
      SELECT DISTINCT speed
      FROM pc)
```

## –ó–∞–¥–∞–Ω–∏–µ 18

–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π —Å–∞–º—ã—Ö –¥–µ—à–µ–≤—ã—Ö —Ü–≤–µ—Ç–Ω—ã—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤. 

**–í—ã–≤–µ—Å—Ç–∏: maker, price**

```sql
SELECT DISTINCT maker,
                price
FROM product AS prod
JOIN printer AS pr
     ON prod.model = pr.model AND pr.color = 'y'
WHERE pr.price =
    (SELECT min(price)
     FROM printer
     WHERE color = 'y')
```

## –ó–∞–¥–∞–Ω–∏–µ 20

–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π, –≤—ã–ø—É—Å–∫–∞—é—â–∏—Ö –ø–æ –º–µ–Ω—å—à–µ–π –º–µ—Ä–µ —Ç—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –ü–ö. 

**–í—ã–≤–µ—Å—Ç–∏: Maker, —á–∏—Å–ª–æ –º–æ–¥–µ–ª–µ–π –ü–ö.**

```sql
SELECT maker,
       count(DISTINCT model)
FROM product
WHERE TYPE = 'PC'
GROUP BY maker
HAVING count(DISTINCT model) >= 3
```

## –ó–∞–¥–∞–Ω–∏–µ 23

–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∏ –±—ã –∫–∞–∫ –ü–ö
—Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ 750 –ú–ì—Ü, —Ç–∞–∫ –∏ –ü–ö-–±–ª–æ–∫–Ω–æ—Ç—ã —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ 750 –ú–ì—Ü.

**–í—ã–≤–µ—Å—Ç–∏: Maker**

```sql
SELECT pr.maker
FROM product AS pr
JOIN pc
     ON pr.model = pc.model
WHERE pc.speed >= 750
INTERSECT
SELECT pr.maker
FROM product AS pr
JOIN laptop AS l
     ON pr.model = l.model
WHERE l.speed >= 750
```

## –ó–∞–¥–∞–Ω–∏–µ 24

–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –º–æ–¥–µ–ª–µ–π –ª—é–±—ã—Ö —Ç–∏–ø–æ–≤, –∏–º–µ—é—â–∏—Ö —Å–∞–º—É—é –≤—ã—Å–æ–∫—É—é —Ü–µ–Ω—É –ø–æ –≤—Å–µ–π –∏–º–µ—é—â–µ–π—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ü–∏–∏.

```sql
WITH model_with_max_price AS
     (SELECT p.model,
             max(coalesce(l.price, pc.price, pr.price)) AS price
      FROM product AS p
      LEFT JOIN laptop AS l
           ON p.model = l.model
      LEFT JOIN pc
           ON pc.model = p.model
      LEFT JOIN printer AS pr
           ON pr.model = p.model
      GROUP BY p.model)

SELECT model
FROM model_with_max_price
WHERE price =
      (SELECT max(price)
       FROM model_with_max_price)
```

## –ó–∞–¥–∞–Ω–∏–µ 25

–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç –ü–ö —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –æ–±—ä–µ–º–æ–º RAM –∏ —Å —Å–∞–º—ã–º –±—ã—Å—Ç—Ä—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –ü–ö, –∏–º–µ—é—â–∏—Ö –Ω–∞–∏–º–µ–Ω—å—à–∏–π –æ–±—ä–µ–º RAM. 

**–í—ã–≤–µ—Å—Ç–∏: Maker**

```sql
WITH maker_with_speed_and_ram AS
     (SELECT p.maker,
             pc.speed
      FROM product AS p
      JOIN pc
           ON p.model = pc.model
      WHERE pc.ram =
            (SELECT min(ram)
             FROM pc))

SELECT DISTINCT maker
FROM maker_with_speed_and_ram
WHERE speed =
      (SELECT max(speed)
       FROM maker_with_speed_and_ram)
AND maker IN
    (SELECT maker
     FROM product
     WHERE TYPE = 'Printer')
```

## –ó–∞–¥–∞–Ω–∏–µ 26

–ù–∞–π–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É –ü–ö –∏ –ü–ö-–±–ª–æ–∫–Ω–æ—Ç–æ–≤, –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–º A (–ª–∞—Ç–∏–Ω—Å–∫–∞—è –±—É–∫–≤–∞). 

**–í—ã–≤–µ—Å—Ç–∏: –æ–¥–Ω–∞ –æ–±—â–∞—è —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞**

```sql
SELECT avg(coalesce(pc.price, l.price))
FROM product AS p
LEFT JOIN laptop AS l
     ON p.model = l.model
LEFT JOIN pc
     ON p.model = pc.model
WHERE p.maker = 'A'
```

## –ó–∞–¥–∞–Ω–∏–µ 27

–ù–∞–π–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –¥–∏—Å–∫–∞ –ü–ö –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ç–µ—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø—É—Å–∫–∞—é—Ç –∏ –ø—Ä–∏–Ω—Ç–µ—Ä—ã. 

**–í—ã–≤–µ—Å—Ç–∏: maker, —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä HD.**

```sql
WITH cte AS
     (SELECT pr.maker,
             avg(pc.hd) AS Avg_hd
      FROM product AS pr
      JOIN pc
           ON pr.model = pc.model
      GROUP BY pr.maker)

SELECT *
FROM cte
WHERE maker IN
      (SELECT maker
       FROM product
       WHERE TYPE = 'Printer')
```

## –ó–∞–¥–∞–Ω–∏–µ 28

–ò—Å–ø–æ–ª—å–∑—É—è —Ç–∞–±–ª–∏—Ü—É Product, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π, –≤—ã–ø—É—Å–∫–∞—é—â–∏—Ö –ø–æ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏.

```sql
SELECT maker,
       type
FROM product
WHERE maker IN
      (SELECT maker
       FROM product
       GROUP BY maker
       HAVING count(DISTINCT TYPE) = 1)
GROUP BY maker,
         TYPE
HAVING count(model) > 1
```

## –ó–∞–¥–∞–Ω–∏–µ 41

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–æ–¥–µ–ª–∏ —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–π –∏–∑ —Ç–∞–±–ª–∏—Ü PC, Laptop –∏–ª–∏ Printer,
–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –Ω–∞ –µ–≥–æ –ø—Ä–æ–¥—É–∫—Ü–∏—é.
–í—ã–≤–æ–¥: –∏–º—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, –µ—Å–ª–∏ —Å—Ä–µ–¥–∏ —Ü–µ–Ω –Ω–∞ –ø—Ä–æ–¥—É–∫—Ü–∏—é –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç NULL, —Ç–æ –≤—ã–≤–æ–¥–∏—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è NULL,
–∏–Ω–∞—á–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É.

*–ù–µ —Å–æ–≤—Å–µ–º –≤–µ—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ üëá. –ï—Å–ª–∏ —É –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –±—É–¥—É—Ç –æ–¥–Ω–æ–∏–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö, —Ä–µ—à–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏ –ª–µ–≤–æ–º –≤–Ω–µ—à–Ω–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Ç—Ä–æ–∫ –∏ coalesce –º–æ–∂–µ—Ç –Ω–µ –≤–µ—Ä–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –ø–µ—Ä–≤–æ–µ –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–Ω—ã.*
```sql
SELECT maker,
       max(coalesce(pc.price, l.price, p.price))
FROM product
LEFT JOIN pc
     ON product.model = pc.model
LEFT JOIN printer AS p
     ON product.model = p.model
LEFT JOIN laptop AS l
     ON product.model = l.model
GROUP BY maker
HAVING max(pc.price) IS NOT NULL
       OR max(l.price) IS NOT NULL
       OR max(p.price) IS NOT NULL
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**
```sql
SELECT 
    maker, 
    CASE 
        WHEN SUM(CASE WHEN price IS NULL THEN 1 ELSE 0 END) > 0 THEN NULL 
        ELSE MAX(price) 
    END AS max_price
FROM (
    SELECT
          product.maker,
          pc.price
    FROM product 
    JOIN pc
         ON product.model = pc.model
    UNION ALL
    SELECT
          product.maker,
          l.price
    FROM product 
    JOIN laptop l
         ON product.model = l.model
    UNION ALL
    SELECT
          product.maker,
          p.price
    FROM product 
    JOIN printer p
         ON product.model = p.model
) AS all_products
GROUP BY maker
```

## –ó–∞–¥–∞–Ω–∏–µ 58

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Product c —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –¥–≤—É—Ö –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ –Ω–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –∫ –æ–±—â–µ–º—É —á–∏—Å–ª—É –º–æ–¥–µ–ª–µ–π —ç—Ç–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è.

**–í—ã–≤–æ–¥: maker, type, –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –∫ –æ–±—â–µ–º—É —á–∏—Å–ª—É –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è**

```sql
SELECT p.maker,
       temp_table.type,
       cast(ROUND(100.0 * SUM(CASE
                                  WHEN p.type = temp_table.type THEN 1
                                  ELSE 0
                              END) / COUNT(p.model), 2) AS NUMERIC(5, 2)) AS percentage
FROM product AS p
CROSS JOIN
  (SELECT DISTINCT TYPE
   FROM product) AS temp_table
GROUP BY p.maker,
         temp_table.type
ORDER BY p.maker,
         temp_table.type
```

## –ó–∞–¥–∞–Ω–∏–µ 65

–ü—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã {maker, type} –∏–∑ Product, —É–ø–æ—Ä—è–¥–æ—á–∏–≤ –∏—Ö —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
- –∏–º—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è (maker) –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é;
- —Ç–∏–ø –ø—Ä–æ–¥—É–∫—Ç–∞ (type) –≤ –ø–æ—Ä—è–¥–∫–µ PC, Laptop, Printer.
–ï—Å–ª–∏ –Ω–µ–∫–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å –≤—ã–ø—É—Å–∫–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –ø—Ä–æ–¥—É–∫—Ü–∏–∏, —Ç–æ –≤—ã–≤–æ–¥–∏—Ç—å –µ–≥–æ –∏–º—è —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ;
–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –≠–¢–û–ì–û –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É —Å–∏–º–≤–æ–ª–æ–≤ ('').

```sql
WITH cte AS
     (SELECT DISTINCT dense_rank() OVER (PARTITION BY maker
                                         ORDER BY CASE TYPE WHEN 'PC' THEN 1 WHEN 'Laptop' THEN 2 ELSE 3 END) AS r,
                      maker,
                      TYPE
      FROM product)
SELECT row_number() OVER (ORDER BY maker) AS num,
       CASE r WHEN 1 THEN maker ELSE '' END AS maker,
       TYPE
FROM cte
```

## –ó–∞–¥–∞–Ω–∏–µ 71

–ù–∞–π—Ç–∏ —Ç–µ—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ü–ö, –≤—Å–µ –º–æ–¥–µ–ª–∏ –ü–ö –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ PC.

```sql
SELECT maker
FROM product
LEFT JOIN PC
     ON product.model = PC.model
WHERE TYPE = 'PC'
GROUP BY maker
HAVING count(*) - count(PC.model) = 0
ORDER BY 1
```

## –ó–∞–¥–∞–Ω–∏–µ 75

–î–ª—è —Ç–µ—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã —Å –∏–∑–≤–µ—Å—Ç–Ω–æ–π —Ü–µ–Ω–æ–π —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–π –∏–∑ —Ç–∞–±–ª–∏—Ü Laptop, PC, Printer –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ –∫–∞–∂–¥—ã–π –∏–∑ —Ç–∏–ø–æ–≤ –ø—Ä–æ–¥—É–∫—Ü–∏–∏.
–î–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤/—Ü–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NULL.

**–í—ã–≤–æ–¥: maker, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –Ω–∞ –Ω–æ—É—Ç–±—É–∫–∏, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –Ω–∞ –ü–ö, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ç–µ—Ä—ã.**


```sql
SELECT maker,
       max(l.price) AS laptop,
       max(pc.price) AS pc,
       max(r.price) AS printer
FROM Product t
LEFT JOIN Laptop l ON t.model=l.model
LEFT JOIN PC ON t.model=pc.model
LEFT JOIN Printer r ON t.model=r.model
GROUP BY maker
HAVING max(l.price) IS NOT NULL
OR max(pc.price) IS NOT NULL
OR max(r.price) IS NOT NULL
```

## –ó–∞–¥–∞–Ω–∏–µ 80

–ù–∞–π—Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –ª—é–±–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –º–æ–¥–µ–ª–µ–π –ü–ö, –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ PC.

```sql
SELECT DISTINCT maker
FROM product
WHERE maker NOT IN
    (SELECT DISTINCT maker
     FROM product
     WHERE TYPE = 'PC' AND model NOT IN
         (SELECT DISTINCT model
          FROM pc))
ORDER BY 1
```

## –ó–∞–¥–∞–Ω–∏–µ 82

–í –Ω–∞–±–æ—Ä–µ –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã PC, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ —Å—Ç–æ–ª–±—Ü—É code (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é) –Ω–∞–π—Ç–∏ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–π —à–µ—Å—Ç–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥ –∏–¥—É—â–∏—Ö –ü–ö.

**–í—ã–≤–æ–¥: –∑–Ω–∞—á–µ–Ω–∏–µ code, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º –≤ –Ω–∞–±–æ—Ä–µ –∏–∑ —à–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫, —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤ –Ω–∞–±–æ—Ä–µ.**

```sql
WITH cte AS
     (SELECT code,
             avg(price) OVER (ORDER BY code ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS average,
             row_number() OVER (ORDER BY code) AS rang
      FROM pc)
SELECT code,
       average
FROM cte
WHERE rang <=
          (SELECT max(rang) - 5
           FROM cte)
```












