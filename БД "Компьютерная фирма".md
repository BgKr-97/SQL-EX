## Задание 6

Для каждого производителя, выпускающего ПК-блокноты c объёмом жесткого диска не менее 10 Гбайт, найти скорости таких ПК-блокнотов. 

**Вывести: производитель, скорость**.

```sql
SELECT DISTINCT p.maker,
                l.speed
FROM product AS p
JOIN laptop AS l
     ON p.model = l.model AND l.type = 'Laptop'
WHERE l.hd >= 10
```

## Задание 7

Найдите номера моделей и цены всех имеющихся в продаже продуктов (любого типа) производителя B (латинская буква). 

```sql
SELECT DISTINCT P.MODEL,
                COALESCE(PC.PRICE, L.PRICE, PR.PRICE)
FROM PRODUCT AS P
LEFT JOIN PC
     ON PC.MODEL = P.MODEL
LEFT JOIN LAPTOP AS L
     ON L.MODEL = P.MODEL
LEFT JOIN PRINTER AS PR
     ON PR.MODEL = P.MODEL
WHERE P.MAKER = 'B' AND COALESCE(PC.MODEL, L.MODEL, PR.MODEL) IS NOT NULL
```

## Задание 8

Найдите производителя, выпускающего ПК, но не ПК-блокноты.

```sql
SELECT DISTINCT maker
FROM product
WHERE TYPE = 'PC' AND maker NOT IN
      (SELECT DISTINCT maker
       FROM product
       WHERE TYPE = 'Laptop')
```

## Задание 15

Найдите размеры жестких дисков, совпадающих у двух и более PC. 

**Вывести: HD**

```sql
SELECT hd
FROM pc
GROUP BY hd
HAVING count(*) >= 2
```

## Задание 16

Найдите пары моделей PC, имеющих одинаковые скорость и RAM. В результате каждая пара указывается только один раз, т.е. (i,j), но не (j,i), 
Порядок вывода: модель с большим номером, модель с меньшим номером, скорость и RAM.

```sql
SELECT DISTINCT t2.model,
                t1.model,
                t1.speed,
                t1.ram
FROM pc AS t1
JOIN pc AS t2
     ON t1.speed = t2.speed AND t1.ram = t2.ram
WHERE t2.model > t1.model
```

## Задание 17

Найдите модели ПК-блокнотов, скорость которых меньше скорости каждого из ПК.

**Вывести: type, model, speed**

```sql
SELECT DISTINCT 'Laptop',
                model,
                speed
FROM Laptop
WHERE speed < all(
      SELECT DISTINCT speed
      FROM pc)
```

## Задание 18

Найдите производителей самых дешевых цветных принтеров. 

**Вывести: maker, price**

```sql
SELECT DISTINCT maker,
                price
FROM product AS prod
JOIN printer AS pr
     ON prod.model = pr.model AND pr.color = 'y'
WHERE pr.price =
    (SELECT min(price)
     FROM printer
     WHERE color = 'y')
```

## Задание 20

Найдите производителей, выпускающих по меньшей мере три различных модели ПК. 

**Вывести: Maker, число моделей ПК.**

```sql
SELECT maker,
       count(DISTINCT model)
FROM product
WHERE TYPE = 'PC'
GROUP BY maker
HAVING count(DISTINCT model) >= 3
```

## Задание 23

Найдите производителей, которые производили бы как ПК
со скоростью не менее 750 МГц, так и ПК-блокноты со скоростью не менее 750 МГц.

**Вывести: Maker**

```sql
SELECT pr.maker
FROM product AS pr
JOIN pc
     ON pr.model = pc.model
WHERE pc.speed >= 750
INTERSECT
SELECT pr.maker
FROM product AS pr
JOIN laptop AS l
     ON pr.model = l.model
WHERE l.speed >= 750
```

## Задание 24

Перечислите номера моделей любых типов, имеющих самую высокую цену по всей имеющейся в базе данных продукции.

```sql
WITH model_with_max_price AS
     (SELECT p.model,
             max(coalesce(l.price, pc.price, pr.price)) AS price
      FROM product AS p
      LEFT JOIN laptop AS l
           ON p.model = l.model
      LEFT JOIN pc
           ON pc.model = p.model
      LEFT JOIN printer AS pr
           ON pr.model = p.model
      GROUP BY p.model)

SELECT model
FROM model_with_max_price
WHERE price =
      (SELECT max(price)
       FROM model_with_max_price)
```

## Задание 25

Найдите производителей принтеров, которые производят ПК с наименьшим объемом RAM и с самым быстрым процессором среди всех ПК, имеющих наименьший объем RAM. 

**Вывести: Maker**

```sql
WITH maker_with_speed_and_ram AS
     (SELECT p.maker,
             pc.speed
      FROM product AS p
      JOIN pc
           ON p.model = pc.model
      WHERE pc.ram =
            (SELECT min(ram)
             FROM pc))

SELECT DISTINCT maker
FROM maker_with_speed_and_ram
WHERE speed =
      (SELECT max(speed)
       FROM maker_with_speed_and_ram)
AND maker IN
    (SELECT maker
     FROM product
     WHERE TYPE = 'Printer')
```

## Задание 26

Найдите среднюю цену ПК и ПК-блокнотов, выпущенных производителем A (латинская буква). 

**Вывести: одна общая средняя цена**

```sql
SELECT avg(coalesce(pc.price, l.price))
FROM product AS p
LEFT JOIN laptop AS l
     ON p.model = l.model
LEFT JOIN pc
     ON p.model = pc.model
WHERE p.maker = 'A'
```

## Задание 27

Найдите средний размер диска ПК каждого из тех производителей, которые выпускают и принтеры. 

**Вывести: maker, средний размер HD.**

```sql
WITH cte AS
     (SELECT pr.maker,
             avg(pc.hd) AS Avg_hd
      FROM product AS pr
      JOIN pc
           ON pr.model = pc.model
      GROUP BY pr.maker)

SELECT *
FROM cte
WHERE maker IN
      (SELECT maker
       FROM product
       WHERE TYPE = 'Printer')
```

## Задание 28

Используя таблицу Product, определить количество производителей, выпускающих по одной модели.

```sql
SELECT maker,
       type
FROM product
WHERE maker IN
      (SELECT maker
       FROM product
       GROUP BY maker
       HAVING count(DISTINCT TYPE) = 1)
GROUP BY maker,
         TYPE
HAVING count(model) > 1
```

## Задание 71

Найти тех производителей ПК, все модели ПК которых имеются в таблице PC.

```sql
SELECT maker
FROM product
LEFT JOIN PC
     ON product.model = PC.model
WHERE TYPE = 'PC'
GROUP BY maker
HAVING count(*) - count(PC.model) = 0
ORDER BY 1
```

## Задание 75

Для тех производителей, у которых есть продукты с известной ценой хотя бы в одной из таблиц Laptop, PC, Printer найти максимальные цены на каждый из типов продукции.
Для отсутствующих продуктов/цен использовать NULL.

**Вывод: maker, максимальная цена на ноутбуки, максимальная цена на ПК, максимальная цена на принтеры.**


```sql
SELECT maker,
       max(l.price) AS laptop,
       max(pc.price) AS pc,
       max(r.price) AS printer
FROM Product t
LEFT JOIN Laptop l ON t.model=l.model
LEFT JOIN PC ON t.model=pc.model
LEFT JOIN Printer r ON t.model=r.model
GROUP BY maker
HAVING max(l.price) IS NOT NULL
OR max(pc.price) IS NOT NULL
OR max(r.price) IS NOT NULL
```

## Задание 80

Найти производителей любой компьютерной техники, у которых нет моделей ПК, не представленных в таблице PC.

```sql
SELECT DISTINCT maker
FROM product
WHERE maker NOT IN
    (SELECT DISTINCT maker
     FROM product
     WHERE TYPE = 'PC' AND model NOT IN
         (SELECT DISTINCT model
          FROM pc))
ORDER BY 1
```



















